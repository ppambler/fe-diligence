### âœï¸ Tangxt â³ 2022-01-07 ğŸ·ï¸ Node.js

# 05-é™æ€æœåŠ¡å™¨

è¿™èŠ‚è®² HTTP æ¨¡å—ï¼Œè¯¥æ¨¡å—å¾ˆé‡è¦ï¼Œæœ‰äº†è¿™ä¸ªæ¨¡å—ï¼Œä½ å°±å¯ä»¥åšæœåŠ¡å™¨å¼€å‘äº† -> è¯¥æ¨¡å—éœ€è¦å€ŸåŠ© C/C++ å†™çš„åº“æ‰å¾—ä»¥å®ç° -> è¯¥ http æ¨¡å—æœ€ç»ˆæš´éœ²å¾ˆå¥½ç”¨çš„ API ä»¥ä¾›æˆ‘ä»¬ä½¿ç”¨

ç†è®ºä¸Šåº”è¯¥å…ˆå­¦ä¹  HTTP åè®®å†å­¦ä¹  HTTP æ¨¡å— -> è·³è¿‡ HTTP åè®®çš„å­¦ä¹ ï¼Œé€‰æ‹©åœ¨å®è·µä¸­å­¦ä¹ è¿™ä¸ª HTTP æ¨¡å—

æ€»ä¹‹ï¼Œåœ¨ä¸äº†è§£ HTTP åè®®å’Œ TS æƒ…å†µä¸‹ï¼Œå»å®è·µï¼Œå®è·µå®Œåï¼Œå†å»çœ‹æ–‡æ¡£

1ï¼‰é…ç½® Webstorm å’Œ VS Code

ğŸ’¡ï¼šä¸€äº›æœ‰ç”¨çš„å·¥å…·

![æœ‰ç”¨çš„å·¥å…·](assets/img/2022-01-07-15-14-05.png)

- node-dev -> ä¸é€‚åˆåœ¨å…¬å¸ä½¿ç”¨ï¼Œå› ä¸ºæ¯æ¬¡éƒ¨ç½²é‡æ–°é‡å¯å³å¯ï¼Œè€Œä¸æ˜¯æ”¹ä¸€ä¸‹ä»£ç å°±é‡å¯ä¸€ä¸‹
- ts-node -> ä¸éœ€è¦æˆ‘ä»¬å®‰è£… babel å°±èƒ½æ”¯æŒ ts åœ¨ node ä¸­ä½¿ç”¨
- ts-node-dev -> äºŒè€…çš„ç»“åˆä½“

``` bash
yarn global add ts-node-dev
# or
npm i -g ts-node-dev
```

![ts-node-dev](assets/img/2022-01-07-18-23-47.png)

ä½¿ç”¨å®ƒçš„æ—¶å€™è¿˜å¾—å®‰è£…`TypeScript`ï¼š

``` bash
npm i typescript -g
```

![typescript](assets/img/2022-01-07-18-41-11.png)

ğŸ’¡ï¼šä¸€äº›æœ‰ç”¨çš„å·¥å…· 2

![2](assets/img/2022-01-07-18-19-38.png)

ğŸ’¡ï¼šä¸€äº›æœ‰ç”¨çš„å·¥å…· 3

![3](assets/img/2022-01-07-18-20-04.png)

![3](assets/img/2022-01-07-18-20-34.png)

2ï¼‰åˆ›å»ºé¡¹ç›®

> åœ¨ VS Code é‡Œè¾¹å†™ TS é¡¹ç›®ï¼š[TypeScript Programming with Visual Studio Code](https://code.visualstudio.com/docs/languages/typescript)

![åˆ›å»ºé¡¹ç›®](assets/img/2022-01-07-18-32-49.png)

ğŸ’¡ï¼šå®‰è£…`@types/node`ï¼Œè®©å¼€å‘å·¥å…·çŸ¥é“ node é‡Œè¾¹æœ‰å“ªäº›æ¨¡å— -> ä¸ºäº†ä»£ç çš„æ™ºèƒ½æç¤º

![æ¨¡å—](assets/img/2022-01-07-18-44-52.png)

ğŸ’¡ï¼šä¸ºä»€ä¹ˆè¦æ·»åŠ `response.end`ï¼Ÿ

ä¸æ·»åŠ ï¼š

![æ•ˆæœ](assets/img/2022-01-07-18-58-20.png)

æ·»åŠ åï¼š

![end](assets/img/2022-01-07-19-02-34.png)

> [Demo](https://github.com/ppambler/fe-diligence-demo/commit/5bd92c6)

3ï¼‰request å¯¹è±¡

å¯¹åˆšæ‰å†™çš„ä»£ç è¿›è¡Œä¸€ä¸ªè¯¦ç»†å’Œå®Œæ•´çš„ç ”ç©¶

1ã€Server æ˜¯ä¸ªä»€ä¹ˆä¸œè¥¿ï¼Ÿ

![Server](assets/img/2022-01-07-20-43-09.png)

ğŸ’¡ï¼šä¸ºå•¥æ¨èçœ‹å®˜æ–¹æ–‡æ¡£ï¼Ÿ

![å®˜æ–¹æ–‡æ¡£](assets/img/2022-01-07-20-02-57.png)

ä¸€äº›å¼€å‘è€…ä¸º node åˆ›å»ºçš„ ts å£°æ˜ï¼Œå®Œå…¨çœ‹ä¸æ‡‚å•Šï¼è·Ÿ node ç»“åˆçš„ä¸å’‹åœ°ï¼

![å®˜æ–¹æ–‡æ¡£](assets/img/2022-01-07-20-30-22.png)

å¦‚ä½•çœ‹æ–‡æ¡£ï¼Ÿ -> æ‰¾å¯¹æˆ‘ä»¬è¿™ä¸ªä»£ç æœ‰ç”¨çš„ APIï¼š

![äº‹ä»¶](assets/img/2022-01-07-20-32-07.png)

æ‰€ä»¥è¯´ï¼Œnode çš„ ts å£°æ˜å†™å¾—ä¸å¥½ï¼Œé‚£ä¹ˆä½ å°±åªèƒ½çœ‹æ–‡æ¡£äº†ï¼

ğŸ’¡ï¼š`net.Server`

![net.Server](assets/img/2022-01-07-20-35-22.png)

ä¸è¿‡è¿™ä¸ª`close`äº‹ä»¶ä¸€èˆ¬ä¸ç”¨ï¼Œæˆ‘ä»¬å¾ˆå°‘ä¼šå…³é—­æœåŠ¡å™¨

å¸¸ç”¨çš„æ˜¯`error`äº‹ä»¶ï¼Œå¦‚æœæœåŠ¡æ–­äº†ï¼Œå°±ä¼šé€šè¿‡è¿™ä¸ªäº‹ä»¶å‘é€ä¸ªçŸ­ä¿¡ç»™å¼€å‘è€…

ğŸ’¡ï¼šä¸ºå•¥è¦ç»™`request`å’Œ`response`æŒ‡å®šç±»å‹ï¼Ÿ

![ç±»å‹](assets/img/2022-01-07-20-51-18.png)

![ç±»å‹](assets/img/2022-01-07-20-55-00.png)

- `class IncomingMessage extends stream.Readable {}`
- `class ServerResponse extends OutgoingMessage {}`ï¼Œ`OutgoingMessage`è¿™ä¸ªç±»ç»§æ‰¿è‡ª`Stream`

æŒ‡å®šç±»å‹åï¼Œæˆ‘ä»¬å°±ä¸ç”¨çœ‹æ–‡æ¡£ï¼Œç›´æ¥çœ‹æç¤ºå†™äº†ï¼

![æµ‹è¯• url](assets/img/2022-01-07-21-02-16.png)

2ã€ç”¨ Node.js è·å–è¯·æ±‚å†…å®¹

![è·å–è¯·æ±‚å†…å®¹](assets/img/2022-01-07-21-38-02.png)

ğŸ’¡ï¼šæµ‹è¯• Get è¯·æ±‚

![Get](assets/img/2022-01-07-21-44-51.png)

ğŸ’¡ï¼šæµ‹è¯• Post è¯·æ±‚

![Post](assets/img/2022-01-07-21-52-00.png)

![Post](assets/img/2022-01-07-21-54-01.png)

4ï¼‰å¦‚ä½•å¾—åˆ°è¯·æ±‚æ¶ˆæ¯ä½“

å¦‚ä½• post è¯·æ±‚çš„è¯·æ±‚ä½“æˆ–è€…è¯´æ˜¯æ¶ˆæ¯ä½“

![ä¹±ç ](assets/img/2022-01-07-23-45-21.png)

è¿™ç§ä¸Šä¼ æ–¹å¼ï¼Œå³ä¾¿ä½ ä¸Šä¼  1 G çš„å†…å®¹ï¼Œæˆ‘éƒ½å¯ä»¥æ‹¿åˆ°ï¼Œå½“ç„¶ï¼Œå‰ææ˜¯æœåŠ¡å™¨å†…å­˜æ˜¯å¤Ÿçš„ï¼Œåªæœ‰å†…å­˜å¤Ÿï¼Œæˆ‘å°±å¯ä»¥ä¸€ç‚¹ä¸€ç‚¹çš„æŠŠæ•°æ®ç»™æ‹¿å®Œâ€¦â€¦

å¤„ç†ä¹±ç ï¼š

``` js
import * as http from "http";
import { IncomingMessage, ServerResponse } from "http";
const iconv = require("iconv-lite");
const server = http.createServer();

server.on("request", (request: IncomingMessage, response: ServerResponse) => {
  console.log(request.method);
  console.log(request.url);
  console.log(request.headers);
  const array = [];
  request.on("data", (chunk) => {
    array.push(chunk);
  });
  request.on("end", () => {
    console.log(array);
    console.log(Buffer.concat(array));
    const body = iconv.decode(Buffer.concat(array), "GBK");
    console.log(body);
    response.end("hi");
  });
});

server.listen(8888);
```

> æœ€å¥½ç»™`concat`æŒ‡å®šæ¯ä¸ª buffer å®ä¾‹åŠ èµ·æ¥çš„æ€»é•¿åº¦ï¼Œæ¯ä¸ª chunk éƒ½æ˜¯ä¸€ä¸ª buffer å®ä¾‹ï¼Œå½“ä½ åœ¨`concat`è¿™äº› buffer å®ä¾‹çš„æ—¶å€™ï¼Œ`concat`å†…éƒ¨å°±ä¸ä¼šé‡æ–°è®¡ç®—æ¯ä¸ª `buffer` å®ä¾‹åŠ èµ·æ¥çš„æ€»é•¿åº¦äº†

![ä¹±ç ](assets/img/2022-01-07-23-46-57.png)

> å³ä¾¿ locale éƒ½æ˜¯ UTF-8ï¼Œä½†è¿™ä¸Šä¼ çš„æ•°æ®è¿˜æ˜¯ GBKï¼

- [Nodeâ€”â€” GBK ç¼–ç æ ¼å¼çš„ Buffer è½¬å­—ç¬¦ä¸²ä¸­æ–‡](https://blog.csdn.net/qq812457115/article/details/104691864)
- [nodejs ä¸­ å¦‚ä½•å°†ä¸€ä¸ª utf8 å­—ç¬¦ä¸²è½¬ä¸º gbk å­—ç¬¦ä¸²ï¼Ÿ - çŸ¥ä¹](https://www.zhihu.com/question/26121387)
- [curl åä¸­æ–‡ä¹±ç ï¼Ÿ - SegmentFault æ€å¦](https://segmentfault.com/q/1010000010619086)
- [3. Buffer çš„è½¬æ¢ï¼Œç»ˆç«¯çš„ä¹±ç çš„å½¢æˆã€‚ - ç®€ä¹¦](https://www.jianshu.com/p/1a4583ec4d3c)
- [ã€æ·±å…¥æ¢ç©¶ Nodeã€‘ï¼ˆ5ï¼‰â€œBuffer ä¸ä¹±ç çš„æ•…äº‹â€ æœ‰åé—®-æŠ€æœ¯åœˆ](https://jishuin.proginn.com/p/763bfbd5f744)
- [Buffer ä¸ä¸­æ–‡ä¹±ç é—®é¢˜ - åˆ˜é›·çš„åšå®¢ - Ray's Blog ](https://isliulei.com/article/node-Buffer/)

ğŸ’¡ï¼šä¸ºä»€ä¹ˆ`request`å¯¹è±¡å¯ä»¥ç›‘å¬åˆ°`data`äº‹ä»¶ï¼Ÿ

![data äº‹ä»¶](assets/img/2022-01-07-22-00-15.png)

`data`äº‹ä»¶æ˜¯ä¸åœè§¦å‘çš„ï¼Œæ ¹æ®åè®®ï¼Œæ¯æ¬¡ä¸Šä¼ çš„æ•°æ®æ˜¯æœ‰é™åˆ¶çš„ï¼Œä¸å¯èƒ½ä¸€æ¬¡ä¸Šä¼ å®Œæ‰€æœ‰æ•°æ®â€¦â€¦

`chunk` -> ä¸€å°å—ä»£ç ï¼Œæˆ–ä¸€å°å—æ•°æ® -> æ¯ä¸€ä¸ª`chunk`éƒ½æ˜¯ä¸€ä¸ª `Buffer`ï¼Œé€šè¿‡å®ƒæä¾›çš„`concat`æ–¹æ³•å¯ä»¥æŠŠè¿™äº›å°å—æ•°æ®è¿æ¥æˆä¸€å¤§ä¸²æ•°æ® -> è¯´ç™½äº†ï¼Œå°±æ˜¯è¿˜åŸå®Œæ•´æ•°æ®ï¼

è¿˜éœ€è¦ç›‘å¬ä¸Šä¼ å·²ç»“æŸçš„äº‹ä»¶ -> `end`

å¯¹äº†ï¼Œè¦å¯¹è¿™ä¸ªè¯·æ±‚å¤„ç†å®Œåï¼Œå†å»å“åº”ï¼Œä¹Ÿå°±æ˜¯æŠŠ`response.end("hi")`å†™åœ¨`request.on`çš„å›è°ƒé‡Œè¾¹

ğŸ’¡ï¼šè¯·æ±‚ä½“é‡Œè¾¹å¯ä»¥å®¹çº³å¤šå°‘æ•°æ®ï¼Ÿ

> post ç†è®ºä¸Šè®²æ˜¯æ²¡æœ‰å¤§å°é™åˆ¶çš„ï¼ŒHTTP åè®®è§„èŒƒä¹Ÿæ²¡æœ‰è¿›è¡Œå¤§å°é™åˆ¶ï¼Œä½†å®é™…ä¸Š post æ‰€èƒ½ä¼ é€’çš„æ•°æ®é‡å¤§å°å–å†³äºæœåŠ¡å™¨çš„è®¾ç½®å’Œå†…å­˜å¤§å°

5ï¼‰response å¯¹è±¡

![response](assets/img/2022-01-08-17-38-55.png)

> TCP è¿™ä¸ª -> æ¶‰åŠåˆ°åˆ†æ®µä¸Šä¼  -> ä¸Šä¼ çš„æ•°æ® 99% æ˜¯ Buffer

ğŸ’¡ï¼šå¦‚æœå“åº”çš„çŠ¶æ€ç æ˜¯ `404`ï¼Ÿ

![404](assets/img/2022-01-08-17-48-31.png)

ğŸ’¡ï¼šè®¾ç½®å“åº”å¤´å’Œå“åº”ä½“

> é‚£ä¸ª`Date`å“åº”å¤´ä¸è¦æ”¹ï¼Œä¸ç„¶å¾ˆæœ‰å¯èƒ½ä¼šå‡ºç°é—®é¢˜

- `write`å¯ä»¥è°ƒç”¨å¤šæ¬¡ï¼Œæ¯æ¬¡è¿”å›éƒ¨åˆ†å†…å®¹

æ•´ä¸ªå“åº”éƒ½æ˜¯ Node.js æ§åˆ¶çš„ï¼Œå®ƒèƒ½æ§åˆ¶å“åº”çš„æ¯ä¸€ä¸ªéƒ¨åˆ†ï¼š

![response å¯¹è±¡](assets/img/2022-01-08-18-07-59.png)

6ï¼‰å®Œæˆç›®æ ‡ 1ï¼šæ ¹æ® url è¿”å›ä¸åŒçš„æ–‡ä»¶

ä¸€ä¸ªç½‘é¡µæœ‰ htmlã€cssã€js ç­‰ä¸åŒçš„æ–‡ä»¶

é™æ€æ–‡ä»¶ä¸€èˆ¬æ”¾åœ¨`static`æˆ–è€…`public`ç›®å½•é‡Œè¾¹ -> è¿™ä¸ªç›®å½•é‡Œè¾¹çš„ä»£ç æ˜¯è¿è¡Œåœ¨æµè§ˆå™¨ä¸Šçš„ï¼Œå¯ä¸æ˜¯ Node è¿™ä¸ªç¯å¢ƒé‡Œè¾¹

ğŸ’¡ï¼šæ·»åŠ å“åº”å¤´`Content-type`ï¼Ÿ

![å“åº”å¤´](assets/img/2022-01-08-19-11-45.png)

å½“ç„¶ï¼Œä½ ä¸åŠ ä¹Ÿå¯ä»¥ï¼š

![ä¸åŠ å“åº”å¤´](assets/img/2022-01-08-19-15-28.png)

ä¸è¿‡ï¼Œå»ºè®®æœ€å¥½åŠ ä¸Šï¼ä¸ç„¶ï¼Œå¾ˆæœ‰å¯èƒ½ä¼šå‡ºç°æŸç§é—®é¢˜

å½“ä½ è¯·æ±‚`http://localhost:8888/index.html`ï¼Œåœ¨è§£æ`index.html`è¿™ä¸ªæ–‡ä»¶å†…å®¹çš„æ—¶å€™ä¹Ÿä¼šå‘é€è¯·æ±‚ï¼š

- `http://localhost:8888/style.css`
- `http://localhost:8888/main.js`

![æ•ˆæœ](assets/img/2022-01-08-19-20-05.png)

> [Demo](https://github.com/ppambler/fe-diligence-demo/commit/67939ad)

7ï¼‰å®Œæˆç›®æ ‡ 2ï¼šå¤„ç†æŸ¥è¯¢å‚æ•°

> æç¤ºï¼šä½¿ç”¨ `url.parse`

ä¸ºä»€ä¹ˆè¦å¤„ç†æŸ¥è¯¢å‚æ•°ï¼Ÿ

![å¤„ç†æŸ¥è¯¢å‚æ•°](assets/img/2022-01-08-19-22-45.png)

![æŸ¥è¯¢å‚æ•°](assets/img/2022-01-08-19-24-27.png)

ç®€å•å¤„ç†æŸ¥è¯¢å‚æ•°ï¼š

![æŸ¥è¯¢å‚æ•°](assets/img/2022-01-08-19-26-47.png)

ä¸è®¤è¯†çš„è·¯å¾„éƒ½èµ°`404`ï¼Œè¯¥æœåŠ¡å™¨åªè®¤è¯†ï¼š`/index.html`ã€`/style.css`ã€`/main.js`è¿™ä¸‰ä¸ªè·¯å¾„

ğŸ’¡ï¼šæ”¹åå­—

![åå­—](assets/img/2022-01-08-19-31-35.png)

ğŸ’¡ï¼š`url.path`è§£æè·¯å¾„ä¼šå¾—åˆ°å•¥ï¼Ÿ

è¯·æ±‚ï¼š`http://localhost:8888/index.html?q=1`

``` js
import * as url from "url";
const object = url.parse(path);
```

![url](assets/img/2022-01-08-19-35-57.png)

ğŸ’¡ï¼šä¸ç®¡ä½ ä¼ å…¥ä»€ä¹ˆæŸ¥è¯¢å­—ç¬¦ä¸²ï¼ŒServer éƒ½å¿½è§†æ‰

![å¿½è§†æŸ¥è¯¢å­—ç¬¦ä¸²](assets/img/2022-01-08-19-40-58.png)

ä½¿ç”¨`url.parse`å¾—åˆ°æ–°çš„è·¯å¾„ï¼Œè®©è¿™ä¸ªè·¯å¾„ä½œä¸º`switch`çš„å‚æ•°

8ï¼‰å®Œæˆç›®æ ‡ 3ï¼šåŒ¹é…ä»»æ„æ–‡ä»¶

é—®é¢˜ï¼šå¢åŠ æ–‡ä»¶ï¼Œéš¾é“åˆå¾—å»å†™ä¸€ä¸ª`case`å—ï¼Ÿ

![æ·»åŠ æ–‡ä»¶](assets/img/2022-01-08-19-57-41.png)

æˆ‘ä»¬å¸Œæœ›æ–‡ä»¶è¿½åŠ äº†ï¼Œä¹Ÿä¸ç”¨å»æ”¹ Server çš„ä»£ç ï¼Œè€Œæ˜¯ä¼šè‡ªåŠ¨åŒ¹é…è¿™ä¸ªæ–‡ä»¶è·¯å¾„

è§‚å¯Ÿä»£ç å¾—çŸ¥ï¼š

![ä¸åŒä¹‹å¤„](assets/img/2022-01-08-19-59-47.png)

ä»£ç ï¼š

![ä»£ç ](assets/img/2022-01-08-20-12-58.png)

ğŸ’¡ï¼š`response.end`ä¸ç­‰äºè¿™ä¸ªå‡½æ•°ä»¥è¿”å›ï¼Œåªæ˜¯å“åº”ç»“æŸç½¢äº†

![å“åº”ç»“æŸ](assets/img/2022-01-08-20-20-02.png)

ğŸ’¡ï¼šä¸ºä»€ä¹ˆä¸€å®šè¦åŠ `content-type`ï¼Ÿ

![content-type](assets/img/2022-01-08-20-30-18.png)

â¹ï¼š[MIME ç±»å‹ - HTTP - MDN](https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Basics_of_HTTP/MIME_types)

9ï¼‰å®Œæˆç›®æ ‡ 4ï¼šå¤„ç†ä¸å­˜åœ¨çš„æ–‡ä»¶

> æç¤ºï¼šè¿”å›ä¸€ä¸ª 404 é¡µé¢

![404 é¡µé¢](assets/img/2022-01-08-22-33-21.png)

> å¯¹äºé™æ€æœåŠ¡å™¨ -> æ‰€è°“çš„ url è·¯å¾„ï¼Œå®è´¨ä¸Šå°±æ˜¯å¯¹åº”ç€æœ¬åœ°ç£ç›˜é‡Œçš„æŸä¸ªæ–‡ä»¶ï¼Œå½“ç„¶ï¼Œæˆ‘ä»¬æ˜¯å¯ä»¥ä¿®æ”¹æˆä¸å¯¹åº”çš„ï¼Œä½†æ¯•ç«Ÿè¿™æ˜¯é™æ€æœåŠ¡å™¨ï¼Œæ‰€ä»¥è¿™æ²¡å¿…è¦å“ˆï¼

> [Demo](https://github.com/ppambler/fe-diligence-demo/commit/c81b19b)

é”™è¯¯ï¼Ÿ -> åˆ†å¾ˆå¤šç§

å¦‚æœä½ é‡åˆ°`500`é”™è¯¯ -> ä¸€èˆ¬æŠŠè¿™æ ·çš„é”™è¯¯å½’ä¸ºæœåŠ¡å™¨ç¹å¿™ï¼Œæ¯•ç«Ÿè¿™ç§é”™è¯¯æ— æ³•æµ‹è¯•å¾—çŸ¥

ğŸ’¡ï¼š`readFile`å‡ºé”™æ—¶ï¼Œå…¶`error`çš„è¿”å›å€¼ï¼Ÿ

![é”™è¯¯ç ](assets/img/2022-01-08-20-49-11.png)

ğŸ’¡ï¼šè¿”å›å›¾ç‰‡ï¼Ÿ

![å›¾ç‰‡](assets/img/2022-01-08-21-09-11.png)

![è¿”å›å›¾ç‰‡](assets/img/2022-01-08-21-10-06.png)

æµè§ˆå™¨ä¼šè‡ªåŠ¨è§£æäºŒè¿›åˆ¶æ•°æ®

ğŸ’¡ï¼š`filename`æœ‰å¯èƒ½æ˜¯ç©ºçš„ï¼Ÿ

![filename](assets/img/2022-01-08-21-15-37.png)

ä¸ºä»€ä¹ˆå‰ç«¯å–œæ¬¢æŠŠç¬¬ä¸€ä¸ªé¡µé¢å«åš`index.html`ï¼Ÿ

è¿™æ˜¯ä¸æˆæ–‡çš„è§„å®šï¼Œå¦‚æœå‘ç°ç”¨æˆ·æ²¡æœ‰å¡«è·¯å¾„ï¼Œé‚£ä¹ˆé»˜è®¤å°±æ‰“å¼€`index.html`

![index](assets/img/2022-01-08-22-08-02.png)

ğŸ’¡ï¼šåœ¨æµè§ˆè®¿é—®ç›®å½•ï¼Ÿ

![è®¿é—®ç›®å½•](assets/img/2022-01-08-22-15-25.png)

ğŸ’¡ï¼šä¸ºä»€ä¹ˆ`html`æ–‡ä»¶é‡Œè¾¹çš„å›¾ç‰‡è·¯å¾„ä¸è¦å†™ç›¸å¯¹è·¯å¾„ï¼Ÿ

å†™ç›¸å¯¹è·¯å¾„ï¼š

![ç›¸å¯¹è·¯å¾„](assets/img/2022-01-08-22-20-30.png)

å†™ç»å¯¹è·¯å¾„ï¼š

![ç»å¯¹è·¯å¾„](assets/img/2022-01-08-22-22-24.png)

æŠŠå½“å‰è¿™ä¸ª`public`è®¾ç½®ä¸ºæ ¹ç›®å½• -> è¿™æ˜¯ wb éœ€è¦é…ç½®çš„ï¼ŒVS Code ä¸éœ€è¦

![å›¾ç‰‡åœ°å€å¤„ç†](assets/img/2022-01-08-22-31-01.png)

10ï¼‰å®Œæˆç›®æ ‡ 5ï¼šå¤„ç†é GET è¯·æ±‚

> æç¤ºï¼š`405 Method Not Allowed` -> ç¦ç”¨è¯·æ±‚ä¸­æŒ‡å®šçš„æ–¹æ³•

ç”¨æˆ·æœ‰æ—¶å€™å‘èµ·çš„ä¸æ˜¯ `GET` è¯·æ±‚ï¼Œæ¯”å¦‚ï¼š

![post](assets/img/2022-01-09-15-45-14.png)

å‘Šè¯‰ç”¨æˆ·ä¸æ˜¯æ–‡ä»¶ä¸å­˜åœ¨ï¼Œè€Œæ˜¯ä¸èƒ½ç”¨`POST`è¯·æ±‚ï¼Œæ¯•ç«Ÿæˆ‘ä»¬è¿™æ˜¯ä¸€ä¸ªé™æ€æœåŠ¡å™¨å•Š

ğŸ’¡ï¼šé‡åˆ° `POST` è¯·æ±‚ï¼Ÿå“åº” `405`ï¼Ÿ

![405](assets/img/2022-01-09-15-54-10.png)

ğŸ’¡ï¼šé‡åˆ°`POST`è¯·æ±‚ï¼Ÿç»™ä¸ªå‡å“åº”ï¼Ÿ

![å‡å“åº”](assets/img/2022-01-09-15-58-26.png)

ğŸ’¡ï¼šéš¾é“åªå¤„ç†`POST`å—ï¼Ÿå…¶å®ƒçš„è¯·æ±‚åŠ¨ä½œå‘¢ï¼Ÿ

![405](assets/img/2022-01-09-16-00-40.png)

11ï¼‰å®Œæˆç›®æ ‡ 6ï¼šæ·»åŠ ç¼“å­˜é€‰é¡¹

> æç¤ºï¼š[Cache-Control](https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Headers/Cache-Control#%E7%BC%93%E5%AD%98%E9%9D%99%E6%80%81%E8%B5%84%E6%BA%90)

ğŸ’¡ï¼šä»€ä¹ˆæ˜¯ç¼“å­˜ï¼Ÿ

æ²¡æœ‰ç¼“å­˜çš„æƒ…å†µï¼š

![æ— ç¼“å­˜](assets/img/2022-01-09-16-06-16.png)

æˆ‘ä»¬å¸Œæœ›ç¬¬äºŒæ¬¡è¯·æ±‚çš„å†…å®¹è·Ÿä¸Šæ¬¡æ˜¯ä¸€æ ·çš„ï¼Œé‚£å°±ä¸è¦å†å‘é€è¯·æ±‚äº†

![ç¼“å­˜](assets/img/2022-01-09-16-15-12.png)

å¯¹äºç¼“å­˜ï¼Œæµè§ˆå™¨ä¼šåˆ°å†…å­˜æˆ–ç¡¬ç›˜é‡Œè¾¹å»è¯»

æ³¨æ„ï¼šåªæœ‰é¦–é¡µæ˜¯ä¸èƒ½ç¼“å­˜çš„ï¼Œæµè§ˆå™¨ä¸æ¥å—é¦–é¡µç¼“å­˜ï¼Œè€Œå…¶å®ƒæ–‡ä»¶æ˜¯å¯ä»¥ç¼“å­˜çš„

ğŸ’¡ï¼šä¸è¦å†™æ­»ç¼“å­˜æ—¶é—´

![ç¼“å­˜](assets/img/2022-01-09-16-16-42.png)

![ç¼“å­˜](assets/img/2022-01-09-16-18-59.png)

åœ¨æµ‹è¯•è¿™ä¸ªä»£ç å‰ï¼Œå…ˆå‹¾é€‰ä¸€ä¸‹`Disable cache`æ¥å®Œæˆç¬¬ä¸€æ¬¡ä¸è¦ç¼“å­˜çš„è¯·æ±‚ï¼Œä¹‹åç¬¬äºŒæ¬¡è¯·æ±‚å‰ï¼Œå°±å»æ‰å‹¾é€‰

![ç¼“å­˜èµ„æº](assets/img/2022-01-09-16-23-58.png)

ğŸ’¡ï¼šæˆ‘ä»¬å¸Œæœ›åœ¨å¯åŠ¨è¿™ä¸ªæœåŠ¡å™¨åº”ç”¨çš„æ—¶å€™ï¼Œæ·»åŠ ç¼“å­˜é€‰é¡¹

ç›®å‰æˆ‘ä»¬å¯åŠ¨åº”ç”¨æ˜¯è¿™æ ·çš„ï¼š

``` bash
ts-node-dev index.ts
```

æˆ‘ä»¬å¸Œæœ›ï¼š

``` bash
ts-node-dev index.ts -c 100
```

å°±æ˜¯åœ¨ç¼“å­˜`100 s`

æ‰€ä»¥æˆ‘ä»¬éœ€è¦è·å–å¯åŠ¨åº”ç”¨æ—¶ç”¨æˆ·æ‰€ä¼ çš„å‚æ•°ï¼Œä¹Ÿå°±æ˜¯`-c 100`

å‚è€ƒä¸Šä¸€èŠ‚çš„`node-todo`åº”ç”¨ -> åˆ›å»ºä¸€ä¸ª`cli.ts`å»è¯»å–å‚æ•° -> å†è¯»å–çš„å‚æ•°ä¼ ç»™é‚£ä¸ªç¼“å­˜å˜é‡

è¿™æ ·ä¸€æ¥ï¼Œåœ¨è¿™ä¸ªç¼“å­˜æ—¶é—´å†…ï¼Œå¯¹äºè¢«å·²ç»ç¼“å­˜çš„æ–‡ä»¶ï¼Œä½ å†æ¬¡é‡æ–°å‘èµ·è¯·æ±‚ï¼Œæ˜¯ä¸ä¼šå»è®¿é—®æœåŠ¡å™¨çš„ï¼Œè€Œæ˜¯ç›´æ¥ä»ç¼“å­˜é‡Œè¾¹æ‹¿æ•°æ®ï¼

ğŸ’¡ï¼šä½¿ç”¨ç¼“å­˜çš„ç½‘ç«™ï¼Ÿ

![ç¼“å­˜](assets/img/2022-01-09-16-35-36.png)

ğŸ’¡ï¼šæ‰€æœ‰èµ„æºéƒ½ç¼“å­˜

å¦‚ä½•è®©ç¼“å­˜å¤±æ•ˆï¼Ÿ -> è¯·æ±‚çš„æ–‡ä»¶æ˜¯æœ‰åç¼€çš„

![ç¼“å­˜](assets/img/2022-01-09-16-41-09.png)

å¦‚æœæ–‡ä»¶çš„è·¯å¾„ä¸ä¼šå› ä¸ºå†…å®¹å˜åŒ–è€Œæ›´æ–°ï¼Œé‚£å°±ä¸è¦åšç¼“å­˜äº†

ä¸€èˆ¬åšç¼“å­˜æ˜¯åœ¨ Nginx é‡Œè¾¹é…ç½®çš„

å½“ç„¶ï¼Œä¹Ÿå¯ä»¥ç”¨ Node.js æ¥åšï¼Œæ¯”å¦‚`js`æ–‡ä»¶ï¼Œç¼“å­˜ 10 å¤©ï¼Œå›¾ç‰‡æ–‡ä»¶ï¼Œç¼“å­˜ 10 å¹´ç­‰ç­‰

![ç¼“å­˜å¤©æ•°](assets/img/2022-01-09-16-44-36.png)

12ï¼‰å®Œæˆç›®æ ‡ 7ï¼šå“åº”å†…å®¹å¯ç”¨ gzip

> å¯é€‰ç›®æ ‡ -> æç¤ºï¼š[zlib æ–‡æ¡£](http://nodejs.cn/api/zlib.html)

è¿™ä¸ªæ“ä½œä¸æ˜¯å‰ç«¯åšçš„ï¼

13ï¼‰å¯¹æ¯”ä¸šç•Œä¼˜ç§€æ¡ˆä¾‹

![ä¼˜ç§€æ¡ˆä¾‹](assets/img/2022-01-09-16-47-00.png)

- [http-server  -  npm](https://www.npmjs.com/package/http-server)
- [node-static  -  npm](https://www.npmjs.com/package/node-static)

æŸ¥çœ‹å®ƒä»¬çš„ Github HomePage

ğŸ’¡ï¼š`http-server`

- ` http-server [path] [options]` -> `path`ç›¸å½“äºæ˜¯æˆ‘ä»¬æŒ‡å®šçš„`public`ç›®å½•

![ç¼“å­˜](assets/img/2022-01-09-16-53-43.png)

çœ‹åˆ«äººæ˜¯æ€ä¹ˆå†™çš„ï¼Œé‚£ä½ å°±å¯ä»¥æ ¹æ®å®ƒçš„æè¿°ï¼Œæ¥å®Œå–„è‡ªå·±çš„é™æ€æœåŠ¡å™¨

ğŸ’¡ï¼š`node-static`

å¯ä»¥é¢å‘ç¨‹åºå‘˜ï¼Œç„¶ååŸºäºå®ƒå†™è‡ªå·±çš„é™æ€æœåŠ¡å™¨ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨å‘½ä»¤è¡Œæ¥ä½¿ç”¨åŸºæœ¬çš„é™æ€æœåŠ¡å™¨åŠŸèƒ½

---

ç»“åˆå®ƒä»¬ä¿©ï¼Œä½ å°±å¯ä»¥åšä¸€ä¸ªéå¸¸å¥½ç”¨çš„é™æ€æœåŠ¡å™¨äº†ï¼

ğŸ’¡ï¼šä¸ºå•¥è¦åšé™æ€æœåŠ¡å™¨ï¼Ÿ

![å‘å¸ƒ](assets/img/2022-01-09-16-57-55.png)

å‘å¸ƒåˆ° npmï¼Œä¸‰ä¸ªæœˆå†…ä¸åœçš„åŠ åŠŸèƒ½ï¼Œä½ å°±èƒ½å¾—åˆ°ä¸€ä¸ªæ­£ç‰ˆçš„ Webstorm äº†

è®¿é—®è¿™ä¸ªåœ°å€ï¼š[Licenses for Open Source Development - Community Support](https://www.jetbrains.com/community/opensource/#support)

å¦‚æœä½ æ˜¯å¼€æºç¤¾åŒºçš„è´¡çŒ®è€…ï¼Œé‚£ä¹ˆå°±å¯ä»¥ä½¿ç”¨ JB è¿™ä¸ªå…¬å¸æ¨å‡ºçš„æ‰€æœ‰ IDE

Who can get free licensesï¼Ÿ

![ç”³è¯·æ¡ä»¶](assets/img/2022-01-09-17-02-14.png)

- ä½ çš„è¿™ä¸ªé™æ€æœåŠ¡å™¨é¡¹ç›®
- æ·»åŠ  MIT åè®®
- ä¸ç›ˆåˆ©
- æ¯ä¸ªæœˆè‡³å°‘æœ‰ä¸€æ¬¡æäº¤
- æ¯æ¬¡å®Œæˆä¸€ä¸ªåŠŸèƒ½æˆ–è€…ä¿®å¤æŸä¸ª bugï¼Œå°±æ›´æ–°ä¸€æ¬¡ç‰ˆæœ¬å‘—ï¼

æ¡ä»¶æ»¡è¶³åï¼Œè®¿é—®è¿™ä¸ªåœ°å€ï¼š[Request for Open Source Development License](https://www.jetbrains.com/shop/eform/opensource?product=ALL)

å¼€å§‹ä½ çš„ç”³è¯·

æ³¨æ„ï¼š

![æ³¨æ„](assets/img/2022-01-09-17-06-37.png)

è¾“å…¥é¡¹ç›®æè¿° -> è°·æ­Œç¿»è¯‘ -> æŠŠä¸­æ–‡ç¿»è¯‘æˆè‹±æ–‡ï¼Œç„¶åå¤åˆ¶è¿›å»å³å¯ï¼

ç”³è¯·åï¼Œä¸€å‘¨å†…ä¼šæœ‰æ¢å¤ -> å‘é‚®ä»¶ç»™ä½ 

14ï¼‰æ€»ç»“

![æ€»ç»“](assets/img/2022-01-09-17-12-52.png)